{{- if eq .chezmoi.os "darwin" -}}
#!/bin/bash

set -e

echo "Installing Homebrew packages..."

brew bundle --no-lock --file=/dev/stdin <<EOF
# Taps
tap "derailed/k9s"

# Development Tools
brew "autoconf"
brew "cmake"
brew "coreutils"
brew "diffutils"
brew "gh"
brew "git"
brew "go"
brew "gofumpt"
brew "golang-migrate"
brew "hugo"
brew "ninja"
brew "node"
brew "opam"
brew "opencode"
brew "pyenv"
brew "pyenv-virtualenv"
brew "rbenv"
brew "ruby-build"
brew "sass"
brew "deno"
brew "dart"

# Python Tools
brew "pipx"
brew "python@3.10"
brew "python@3.13"
brew "python@3.14"
brew "ruff"
brew "uv"
brew "virtualenv"

# CLI Tools
brew "actionlint"
brew "autojump"
brew "bat"
brew "buf"
brew "chezmoi"
brew "create-dmg"
brew "firebase-cli"
brew "fzf"
brew "gcalcli"
brew "gemini-cli"
brew "jd"
brew "jq"
brew "jwt-cli"
brew "oniguruma"
brew "oxlint"
brew "ponysay"
brew "pre-commit"
brew "rsync"
brew "shellcheck"
brew "starship"
brew "tflint"
brew "tree"
brew "usage"
brew "vale"
brew "yamlfmt"
brew "yamllint"
brew "ykman"
brew "yt-dlp"
brew "zplug"
brew "zsh-autosuggestions"
brew "zsh-syntax-highlighting"

# AWS Tools
brew "aws-iam-authenticator"
brew "aws-sso-cli"
brew "awscli"
brew "gimme-aws-creds"
brew "saml2aws"

# Kubernetes Tools
brew "consul"
brew "derailed/k9s/k9s"
brew "eksctl"
brew "helm"
brew "kind"
brew "kubectl"
brew "kubectx"
brew "kubie"
brew "kumactl"
brew "minikube"
brew "skaffold"

# Container Tools
brew "docker"
brew "docker-buildx"
brew "docker-completion"
brew "docker-compose"
brew "docker-credential-helper"
brew "lima"

# Database Tools
brew "postgresql@14"

# Security Tools
brew "bitwarden-cli"
brew "gnupg"

# Media Libraries
brew "ffmpeg"
brew "aom"
brew "dav1d"
brew "flac"
brew "fontconfig"
brew "freetype"
brew "frei0r"
brew "fribidi"
brew "giflib"
brew "harfbuzz"
brew "jpeg-turbo"
brew "jpeg-xl"
brew "lame"
brew "libass"
brew "libbluray"
brew "libogg"
brew "librist"
brew "libsamplerate"
brew "libsndfile"
brew "libvidstab"
brew "libvmaf"
brew "libvorbis"
brew "libvpx"
brew "mpg123"
brew "opencore-amr"
brew "opus"
brew "rav1e"
brew "rubberband"
brew "sdl2"
brew "speex"
brew "srt"
brew "svt-av1"
brew "tesseract"
brew "theora"
brew "webp"
brew "x264"
brew "x265"
brew "xvid"
brew "zimg"

# System Libraries
brew "aribb24"
brew "brotli"
brew "c-ares"
brew "ca-certificates"
brew "cairo"
brew "certifi"
brew "cffi"
brew "cjson"
brew "cryptography"
brew "docutils"
brew "gdbm"
brew "gettext"
brew "glib"
brew "gmp"
brew "gnutls"
brew "graphite2"
brew "highway"
brew "icu4c@77"
brew "icu4c@78"
brew "imath"
brew "krb5"
brew "leptonica"
brew "libarchive"
brew "libassuan"
brew "libb2"
brew "libdeflate"
brew "libevent"
brew "libgcrypt"
brew "libgpg-error"
brew "libidn2"
brew "libksba"
brew "libmicrohttpd"
brew "libnghttp2"
brew "libnghttp3"
brew "libngtcp2"
brew "libpng"
brew "libsodium"
brew "libsoxr"
brew "libssh"
brew "libtasn1"
brew "libtiff"
brew "libudfread"
brew "libunibreak"
brew "libunistring"
brew "libusb"
brew "libuv"
brew "libx11"
brew "libxau"
brew "libxcb"
brew "libxdmcp"
brew "libxext"
brew "libxrender"
brew "libyaml"
brew "little-cms2"
brew "lz4"
brew "lzo"
brew "m4"
brew "mbedtls@3"
brew "mise"
brew "mpdecimal"
brew "nettle"
brew "npth"
brew "openexr"
brew "openjpeg"
brew "openjph"
brew "openssl@1.1"
brew "openssl@3"
brew "p11-kit"
brew "pango"
brew "pcre2"
brew "pinentry"
brew "pinentry-mac"
brew "pixman"
brew "pkgconf"
brew "popt"
brew "pycparser"
brew "pydantic"
brew "python-certifi"
brew "readline"
brew "simdjson"
brew "snappy"
brew "sqlite"
brew "unbound"
brew "uvwasi"
brew "xorgproto"
brew "xxhash"
brew "xz"
brew "zeromq"
brew "zstd"

# Applications
cask "1password"
cask "adobe-acrobat-reader"
cask "basictex"
cask "bitwarden"
cask "chatgpt"
cask "contexts"
cask "discord"
cask "elgato-stream-deck"
cask "espanso"
cask "font-fira-code-nerd-font"
cask "font-iosevka"
cask "font-iosevka-nerd-font"
cask "font-iosevka-term-nerd-font"
cask "font-symbols-only-nerd-font"
cask "freedom"
cask "gcloud-cli"
cask "ghostty"
cask "google-cloud-sdk"
cask "google-drive"
cask "google-drive-file-stream"
cask "insomnia"
cask "obsidian"
cask "orbstack"
cask "pgadmin4"
cask "todoist"
cask "todoist-app"
cask "visual-studio-code"
cask "vivaldi"
cask "whisper-hotkey"
cask "xnviewmp"
EOF

# Run FZF install
echo "Setting up FZF..."
$(brew --prefix)/opt/fzf/install --all --no-bash --no-fish

echo "Packages installed successfully"
{{ end -}}